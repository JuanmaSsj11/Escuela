<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Ordena las palabras - LecciÃ³n 2</title>
<link rel="stylesheet" href="estilos.css">
<style>
/* Parpadeos suaves */
body.parpadeo-correcto { animation: flash-verde 0.5s; }
body.parpadeo-error { animation: flash-rojo 0.5s; }
@keyframes flash-verde { 0% { background-color: rgba(0, 255, 0, 0.2); } 100% { background-color: transparent; } }
@keyframes flash-rojo { 0% { background-color: rgba(255, 0, 0, 0.2); } 100% { background-color: transparent; } }

/* Pantalla final */
#pantallaFinal {
    display: none;
    text-align: center;
    margin-top: 50px;
}
#pantallaFinal h2 {
    font-size: 2em;
    margin-bottom: 20px;
}
#pantallaFinal button {
    margin: 10px;
    padding: 12px 25px;
    border-radius: 12px;
    border: none;
    background:#FFB433;
    color:#213448;
    font-weight:bold;
    font-size:18px;
    cursor:pointer;
    box-shadow:0 4px 8px rgba(0,0,0,0.2);
    transition: all 0.3s;
}
#pantallaFinal button:hover { background:#FFA500; transform: scale(1.05); }
</style>
</head>
<body>

<header>
    <button id="btnRegresar" class="btn-regresar">â¬… Regresar</button>
    <h1>Visualiza, Lee y Ordena - LecciÃ³n 2</h1>
    <p class="autores">Autor: Mtro. Felipe Cruz Suastegi - Jefe del Sector IV EducaciÃ³n Primaria<br>
    Co-autor: Juan Manuel Ontiveros DomÃ­nguez</p>
</header>

<!-- Audios -->
<audio id="audio-error" src="audios/error.mp3"></audio>
<audio id="audio-correcto" src="audios/correcto.mp3"></audio>
<audio id="audio-yeh" src="audios/yeh.mp3"></audio>

<div class="juego2" id="juego">
    <div id="imagenFrase"></div>
    <div id="fraseSeleccionada"></div>
    <div id="palabras"></div>
    <button id="verificar">Verificar</button>
</div>

<div id="mensaje"></div>

<!-- Pantalla final -->
<div id="pantallaFinal">
    <h2>ðŸŽ‰ Â¡Felicidades! Completaste la lecciÃ³n</h2>
    <button id="btnJugarNuevo">Jugar de nuevo</button>
    <button id="btnContinuar">Continuar</button>
</div>

<script>
const datos = [
    {img:"uva_verde.png",  frase: ["Ursula come uvas verdes"]},
    {img:"senora.png",     frase: ["Veronica es mi abuela"]},
    {img:"walkman.png",    frase: ["Wilfredo usa su walkman"]},
    {img:"zapatos_azules.png", frase: ["Zenaida usa zapatos azules"]},
    {img:"elotes.png",     frase: ["Elena come elotes tiernos"]}
];

let fraseActualIndex = 0;
let seleccionadas = [];

// ðŸŽµ Audios
const audioError = document.getElementById("audio-error");
const audioCorrecto = document.getElementById("audio-correcto");
const audioYeh = document.getElementById("audio-yeh");

const juegoDiv = document.getElementById("juego");
const pantallaFinal = document.getElementById("pantallaFinal");

function iniciarJuego() {
    // Mostrar interfaz del juego y ocultar pantalla final
    juegoDiv.style.display = "block";
    pantallaFinal.style.display = "none";

    seleccionadas = [];
    document.getElementById("palabras").innerHTML = "";
    document.getElementById("fraseSeleccionada").textContent = "";

    let datosActuales = datos[fraseActualIndex];

    // Imagen arriba
    let imagenDiv = document.getElementById("imagenFrase");
    imagenDiv.innerHTML = `<img src="imagenes/${datosActuales.img}" alt="Imagen frase" class="imagenFrase">`;

    // Indicador
    document.getElementById("fraseSeleccionada").textContent = "Selecciona las palabras en orden:";

    // Palabras desordenadas
    let palabras = datosActuales.frase[0].split(" ");
    let palabrasDesordenadas = [...palabras].sort(()=>Math.random()-0.5);

    palabrasDesordenadas.forEach(palabra=>{
        let btn = document.createElement("button");
        btn.className = "palabra";
        btn.textContent = palabra;

        btn.addEventListener("click", () => {
            if(btn.classList.contains("seleccionada")){
                btn.classList.remove("seleccionada");
                seleccionadas = seleccionadas.filter(p => p !== palabra);
            } else {
                btn.classList.add("seleccionada");
                seleccionadas.push(palabra);
            }
            actualizarFraseSeleccionada();
        });

        document.getElementById("palabras").appendChild(btn);
    });
}

function actualizarFraseSeleccionada(){
    document.getElementById("fraseSeleccionada").textContent = seleccionadas.join(" ");
}

document.getElementById("verificar").addEventListener("click", ()=>{
    let posiblesFrases = datos[fraseActualIndex].frase;
    let textoSeleccion = seleccionadas.join(" ");
    let correcto = posiblesFrases.includes(textoSeleccion);

    mostrarMensaje(correcto);

    if(correcto){
        fraseActualIndex++;
        if(fraseActualIndex < datos.length){
            setTimeout(iniciarJuego, 900);
        } else {
            // ðŸŽ‰ Mostrar pantalla final
            audioYeh.currentTime = 0;
            audioYeh.play();
            juegoDiv.style.display = "none";
            pantallaFinal.style.display = "block";
        }
    } else {
        setTimeout(iniciarJuego, 900);
    }
});

// BotÃ³n regresar
document.getElementById("btnRegresar").addEventListener("click", () => {
    window.location.href = "juego2L2.html";
});

// Pantalla final: botones
document.getElementById("btnJugarNuevo").addEventListener("click", () => {
    // Reinicia el juego desde el inicio
    fraseActualIndex = 0;
    iniciarJuego();
});
document.getElementById("btnContinuar").addEventListener("click", () => {
    window.location.href = "game2.html";
});

function mostrarMensaje(correcto){
    let mensajeDiv = document.getElementById("mensaje");
    mensajeDiv.textContent = correcto ? "Â¡Correcto!" : "Â¡Intenta de nuevo!";
    mensajeDiv.style.background = correcto ? "#4caf50" : "#e53935";
    mensajeDiv.classList.add("visible");

    // ðŸŽµ Sonido + parpadeo
    if(correcto){
        audioCorrecto.currentTime = 0;
        audioCorrecto.play();
        document.body.classList.add("parpadeo-correcto");
        setTimeout(()=>document.body.classList.remove("parpadeo-correcto"), 500);
    } else {
        audioError.currentTime = 0;
        audioError.play();
        document.body.classList.add("parpadeo-error");
        setTimeout(()=>document.body.classList.remove("parpadeo-error"), 500);
    }

    setTimeout(()=>mensajeDiv.classList.remove("visible"), 1000);
}

// Iniciar juego al cargar la pÃ¡gina
iniciarJuego();
</script>
</body>
</html>
