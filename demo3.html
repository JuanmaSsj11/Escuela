<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Ordena las palabras - Demo 3</title>
<style>
body.parpadeo-correcto { animation: flash-verde 0.5s; }
body.parpadeo-error { animation: flash-rojo 0.5s; }

@keyframes flash-verde { 0% { background-color: rgba(0,255,0,0.2); } 100% { background-color: transparent; } }
@keyframes flash-rojo { 0% { background-color: rgba(255,0,0,0.2); } 100% { background-color: transparent; } }

header {
  text-align: center;
  background: linear-gradient(135deg, #1565c0, #1e88e5);
  color: white;
  padding: 20px;
  border-radius: 0 0 25px 25px;
  box-shadow: 0 4px 8px rgba(0,0,0,0.2);
  position: relative;
}
header h1 { margin: 0; }
.btn-regresar {
  position: absolute; left: 20px; top: 20px;
  background-color: #f44336; border: none; color: white;
  font-size: 16px; padding: 8px 12px; border-radius: 8px; cursor: pointer;
}
.btn-regresar:hover { background-color: #d32f2f; }

.juego2 { display: flex; flex-direction: column; align-items: center; gap: 20px; margin-top: 40px; }
#palabras { display: flex; flex-wrap: wrap; justify-content: center; gap: 10px; max-width: 600px; }

.palabra { background-color: #f0f0f0; border: 2px solid #333; border-radius: 8px; padding: 8px 12px; font-size: 18px; cursor: pointer; transition: all 0.2s ease; }
.palabra:hover { background-color: #e3f2fd; }
.palabra.seleccionada { background-color: #90caf9; border-color: #1565c0; }

#verificar { background-color: #1e88e5; color: white; font-size: 18px; padding: 10px 18px; border: none; border-radius: 10px; cursor: pointer; margin-top: 20px; }
#verificar:hover { background-color: #1565c0; }

#mensaje { font-weight: bold; color: white; padding: 10px 20px; border-radius: 10px; display: none; }
#mensaje.visible { display: inline-block; }

.imagenFrase { width: 220px; border-radius: 12px; box-shadow: 0 3px 8px rgba(0,0,0,0.3); cursor: pointer; transition: transform 0.2s ease; }
.imagenFrase:hover { transform: scale(1.05); }

.instruccion-audio { font-size: 18px; color: #1565c0; font-weight: bold; text-align: center; }

#btnContinuar {
  position: fixed;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
  background-color: #1e88e5;
  color: white;
  font-size: 22px;
  padding: 15px 25px;
  border: none;
  border-radius: 12px;
  cursor: pointer;
  display: none;
  box-shadow: 0 5px 15px rgba(0,0,0,0.3);
}
#btnContinuar:hover { background-color: #1565c0; }
</style>
</head>
<body>

<header>
  <button id="btnRegresar" class="btn-regresar">‚¨Ö Regresar</button>
  <h1>Visualiza, Lee y Ordena</h1>
  <p class="autores">Autor: Mtro. Felipe Cruz Suastegi - Jefe del Sector IV Educaci√≥n Primaria<br>
  </p>
</header>

<!-- Audios -->
<audio id="audio-error" src="audios/error.mp3"></audio>
<audio id="audio-correcto" src="audios/correcto.mp3"></audio>
<audio id="audio-yeh" src="audios/yeh.mp3"></audio>

<!-- Audios de las frases -->
<audio id="audio-elefante" src="audios/elefante.mp3"></audio>
<audio id="audio-nino" src="audios/nino_tina.mp3"></audio>

<div class="juego2">
  <p class="instruccion-audio">üîä Da clic en la imagen para escuchar la frase</p>
  <div id="imagenFrase"></div>
  <div id="fraseSeleccionada"></div>
  <div id="palabras"></div>
  <button id="verificar">Verificar</button>
</div>

<div id="mensaje"></div>
<button id="btnContinuar">Continuar</button>

<script>
const datos = [
  { img: "elefante.png", frase: ["El elefante vive en √Åfrica"], audio: "audio-elefante" },
  { img: "nino_tina.png", frase: ["√Ångel se ba√±a en la tina"], audio: "audio-nino" }
];

let fraseActualIndex = 0;
let seleccionadas = [];

const audioError = document.getElementById("audio-error");
const audioCorrecto = document.getElementById("audio-correcto");
const audioYeh = document.getElementById("audio-yeh");

function iniciarJuego() {
  seleccionadas = [];
  document.getElementById("palabras").innerHTML = "";
  document.getElementById("fraseSeleccionada").textContent = "";

  const actual = datos[fraseActualIndex];
  const imagenDiv = document.getElementById("imagenFrase");
  imagenDiv.innerHTML = `<img src="imagenes/${actual.img}" alt="" class="imagenFrase" id="imgFrase">`;

  const img = document.getElementById("imgFrase");
  const audioFrase = document.getElementById(actual.audio);
  img.addEventListener("click", () => { audioFrase.currentTime = 0; audioFrase.play(); });

  document.getElementById("fraseSeleccionada").textContent = "Selecciona las palabras en orden:";
  const palabras = actual.frase[0].split(" ");
  const desordenadas = [...palabras].sort(() => Math.random() - 0.5);

  desordenadas.forEach(palabra => {
    const btn = document.createElement("button");
    btn.className = "palabra";
    btn.textContent = palabra;
    btn.addEventListener("click", () => {
      if (btn.classList.contains("seleccionada")) {
        btn.classList.remove("seleccionada");
        seleccionadas = seleccionadas.filter(p => p !== palabra);
      } else {
        btn.classList.add("seleccionada");
        seleccionadas.push(palabra);
      }
      actualizarFraseSeleccionada();
    });
    document.getElementById("palabras").appendChild(btn);
  });
}

function actualizarFraseSeleccionada() {
  document.getElementById("fraseSeleccionada").textContent = seleccionadas.join(" ");
}

document.getElementById("verificar").addEventListener("click", () => {
  const fraseCorrecta = datos[fraseActualIndex].frase[0];
  const seleccion = seleccionadas.join(" ");
  const esCorrecto = seleccion === fraseCorrecta;

  mostrarMensaje(esCorrecto);

  if (esCorrecto) {
    fraseActualIndex++;
    if (fraseActualIndex < datos.length) {
      setTimeout(iniciarJuego, 900);
    } else {
      audioYeh.currentTime = 0;
      audioYeh.play();
      // Oculta el juego y muestra el bot√≥n continuar
      document.querySelector(".juego2").style.display = "none";
      document.getElementById("btnContinuar").style.display = "inline-block";
    }
  } else {
    setTimeout(iniciarJuego, 900);
  }
});

document.getElementById("btnContinuar").addEventListener("click", () => {
  window.location.href = "demo4.html";
});

document.getElementById("btnRegresar").addEventListener("click", () => {
  window.location.href = "demo2.html";
});

function mostrarMensaje(correcto) {
  const mensaje = document.getElementById("mensaje");
  mensaje.textContent = correcto ? "¬°Correcto!" : "¬°Intenta de nuevo!";
  mensaje.style.background = correcto ? "#4caf50" : "#e53935";
  mensaje.classList.add("visible");

  if (correcto) {
    audioCorrecto.currentTime = 0; audioCorrecto.play();
    document.body.classList.add("parpadeo-correcto");
    setTimeout(() => document.body.classList.remove("parpadeo-correcto"), 500);
  } else {
    audioError.currentTime = 0; audioError.play();
    document.body.classList.add("parpadeo-error");
    setTimeout(() => document.body.classList.remove("parpadeo-error"), 500);
  }

  setTimeout(() => mensaje.classList.remove("visible"), 1000);
}

iniciarJuego();
</script>

</body>
</html>
