<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<title>Juego de S√≠labas - Lecci√≥n 2</title>
<style>
body {
    font-family: "Comic Sans MS", sans-serif;
    background: linear-gradient(135deg,#FBF8EF,#FFB433);
    text-align: center;
    padding: 25px;
}
h1 { color: #213448; text-shadow: 1px 1px 3px rgba(0,0,0,0.2); }

.zona-palabra {
    display: flex; justify-content: center; align-items: center; flex-wrap: wrap;
    gap: 10px; margin: 20px auto; width: 90%; min-height: 100px;
    background: #fff; border-radius: 12px; border: 3px dashed #94B4C1;
    font-size: 22px; padding: 15px;
}

.teclado {
    display: flex; flex-wrap: wrap; justify-content: center; gap: 10px;
    margin-top: 15px;
}

.silaba {
    background-color: #94B4C1;
    border: none; border-radius: 10px; padding: 10px 15px;
    font-size: 20px; cursor: pointer; color: #213448; font-weight: bold;
    transition: all 0.3s;
}
.silaba:hover { background-color: #547792; color: #fff; transform: scale(1.1); }

button {
    margin: 10px; padding: 12px 25px; border-radius: 12px; border: none;
    background:#FFB433; color:#213448; font-weight:bold; font-size:18px; cursor:pointer;
    box-shadow:0 4px 8px rgba(0,0,0,0.2); transition: all 0.3s;
}
button:hover { background:#FFA500; transform: scale(1.05); }

#mensaje { font-weight:bold; font-size:18px; margin-top:15px;}
.final-opciones { margin-top:20px; display:none; }
img.palabra-img { width: 100px; height: 100px; object-fit: contain; margin: 5px; border-radius:8px; cursor:pointer; }
.instrucciones { font-size: 18px; margin-bottom:15px; }
</style>
</head>
<body>

<h1>Arma la palabra con s√≠labas</h1>

<!-- Contenedor del juego completo -->
<div id="juego">
  <p class="instrucciones" id="instrucciones">üîä Escucha el audio de la palabra y arma la palabra correcta haciendo clic en las s√≠labas en orden. Puedes escuchar el audio tantas veces como necesites.</p>
  <div id="palabraActual" class="zona-palabra"></div>
  <div id="teclado" class="teclado"></div>
  <img id="imagenReferencia" class="palabra-img" src="" alt="Referencia">

  <div class="controles">
    <button id="btnEscuchar">üîÅ Escuchar audio</button>
    <button id="btnVerificar">‚úÖ Verificar palabra</button>
    <button id="btnBorrar">üóë Borrar</button>
  </div>

  <p id="mensaje"></p>
</div>

<!-- Pantalla final -->
<div id="opcionesFinal" class="final-opciones"></div>

<script>
const palabrasLeccion = [
  { palabra: "pelota", silabas: ["pe","lo","ta"], img:"pelota.png", audio:"pelota.mp3" },
  { palabra: "casa", silabas: ["ca","sa"], img:"casa.png", audio:"casa.mp3" },
  { palabra: "camisa", silabas: ["ca","mi","sa"], img:"camisa.png", audio:"camisa.mp3" },
  { palabra: "comida", silabas: ["co","mi","da"], img:"comida.png", audio:"comida.mp3" },
  { palabra: "pajaro", silabas: ["p√°","ja","ro"], img:"pajaro.png", audio:"pajaro.mp3" }
];

let palabrasJuego = [];
let palabraIndex = 0;
let silabasSeleccionadas = [];
let correctas = 0;

const palabraDiv = document.getElementById("palabraActual");
const tecladoDiv = document.getElementById("teclado");
const mensaje = document.getElementById("mensaje");
const imagenRef = document.getElementById("imagenReferencia");
const instrucciones = document.getElementById("instrucciones");
const opcionesFinal = document.getElementById("opcionesFinal");
const btnEscuchar = document.getElementById("btnEscuchar");
const btnVerificar = document.getElementById("btnVerificar");
const btnBorrar = document.getElementById("btnBorrar");
const contenedorJuego = document.getElementById("juego");

function iniciarJuego(){
  palabrasJuego = [...palabrasLeccion].sort(()=>0.5-Math.random()).slice(0,5);
  palabraIndex=0; correctas=0;
  contenedorJuego.style.display="block";
  opcionesFinal.style.display="none";
  cargarPalabra();
}

function cargarPalabra(){
  silabasSeleccionadas=[];
  palabraDiv.textContent="";
  mensaje.textContent="";
  tecladoDiv.textContent="";
  const palabraActual = palabrasJuego[palabraIndex];
  imagenRef.src = "imagenes/"+palabraActual.img;

  const silabasRev = palabraActual.silabas.slice().sort(()=>0.5-Math.random());
  silabasRev.forEach(s=>{
    const btn=document.createElement("button");
    btn.textContent = s;
    btn.className="silaba";
    btn.onclick = ()=>{
      silabasSeleccionadas.push(s);
      palabraDiv.textContent = silabasSeleccionadas.join("");
    };
    tecladoDiv.appendChild(btn);
  });

  playAudioActual();
}

function borrarPalabra(){ 
  silabasSeleccionadas=[];
  palabraDiv.textContent="";
}

function verificarPalabra(){
  if(silabasSeleccionadas.length===0) return;
  const palabraActual = palabrasJuego[palabraIndex];
  if(silabasSeleccionadas.join("") === palabraActual.palabra){
    mensaje.textContent="‚úÖ ¬°Correcto!";
    correctas++;
  } else {
    mensaje.textContent="‚ùå Intenta otra vez";
  }
  palabraIndex++;
  if(palabraIndex<palabrasJuego.length){
    setTimeout(cargarPalabra,700);
  } else {
    setTimeout(finalizarJuego,800);
  }
}

function playAudioActual(){
  const palabraActual = palabrasJuego[palabraIndex];
  const audio = new Audio("audios/"+palabraActual.audio);
  audio.play().catch(()=>{});
}

// Click en imagen reproduce audio
imagenRef.addEventListener("click", playAudioActual);

btnEscuchar.addEventListener("click", playAudioActual);
btnVerificar.addEventListener("click", verificarPalabra);
btnBorrar.addEventListener("click", borrarPalabra);

function finalizarJuego(){
  // Ocultar contenedor completo del juego
  contenedorJuego.style.display="none";

  // Mostrar pantalla final
  opcionesFinal.style.display="block";
  if(correctas>=3){
    opcionesFinal.innerHTML=`<p>üéâ ¬°Felicidades! Lograste ${correctas}/5 palabras correctamente.</p>
    <button onclick="window.location.href='lectura1.html'">Continuar</button>
    <button onclick="window.location.href='silabear1.html'">Jugar de nuevo</button>`;
  } else {
    opcionesFinal.innerHTML=`<p>üòÖ Solo lograste ${correctas}/5 palabras. Debes intentarlo otra vez.</p>
    <button onclick="window.location.href='silabear1.html'">Jugar de nuevo</button>`;
  }
}

iniciarJuego();
</script>

</body>
</html>
